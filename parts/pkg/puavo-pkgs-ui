#!/usr/bin/python3

import gi
import subprocess

gi.require_version('Gtk', '3.0')
from gi.repository import Gtk

def on_button_clicked(widget):
    print('button clicked')

def puavoconf_get(puavoconf_key):
  return subprocess.check_output([ 'puavo-conf', puavoconf_key ]).rstrip() \
                   .decode('utf-8')

pkglist = puavoconf_get('puavo.pkgs.ui.pkglist').split()

win = Gtk.Window()
win.connect('destroy', Gtk.main_quit)
win.set_border_width(10)

box_outer = Gtk.Box(orientation=Gtk.Orientation.VERTICAL, spacing=6)
win.add(box_outer)

button = Gtk.Button(label='INSTALL ALL')
button.connect('clicked', on_button_clicked)
box_outer.pack_start(button, True, True, 0)

listbox = Gtk.ListBox()
listbox.set_selection_mode(Gtk.SelectionMode.NONE)
box_outer.pack_start(listbox, True, True, 0)

for pkg in pkglist:
    row = Gtk.ListBoxRow()
    hbox = Gtk.Box(orientation=Gtk.Orientation.HORIZONTAL, spacing=50)
    row.add(hbox)

    label = Gtk.Label(label=pkg)
    button = Gtk.Button(label='INSTALL')
    hbox.pack_start(label, True, True, 0)
    hbox.pack_start(button, True, True, 0)

    listbox.add(row)

win.show_all()

Gtk.main()

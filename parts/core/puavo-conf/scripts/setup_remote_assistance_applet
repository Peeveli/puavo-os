#!/bin/sh

set -eu

vpn_enabled=$(puavo-conf puavo.service.puavo-vpn-client-openvpn.enabled)

if [ "$vpn_enabled" = 'true' ]; then
  puavo_admin_tunnel_interface='tap0'
else
  puavo_admin_tunnel_interface='eth0'
fi

file=/etc/puavo-remote-assistance-applet/config.json
tmpfile="${file}.tmp"

jq --arg interface "$puavo_admin_tunnel_interface" '
    . + { vino_network_interface: $interface }
  ' "$file" > "$tmpfile"

mv "$tmpfile" "$file"
